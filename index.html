<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>RSM</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/png" href="rsm-header.png">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">
<style>
body{margin:0;font-family:'Montserrat',sans-serif;background:#0e0e11;color:#eaeaea;}
header{background:linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.9)),url('https://images.unsplash.com/photo-1500530855697-b586d89ba3ee');background-size:cover;background-position:center;padding:80px 20px;text-align:center;}
header h1{font-family:'Playfair Display',serif;font-size:52px;margin:0;}
nav{background:#15151c;padding:12px;display:flex;gap:15px;align-items:center;flex-wrap:wrap;}
nav a{cursor:pointer;font-weight:600;}
#searchBox{margin-left:auto;position:relative;}
#searchInput{padding:8px 10px;border-radius:20px;border:none;width:220px;}
#searchResults{position:absolute;top:38px;background:#1c1c25;width:100%;border-radius:10px;display:none;z-index:10;}
.search-item{padding:10px;cursor:pointer;}
.search-item:hover{background:#2a2a35;}
main{max-width:900px;margin:auto;padding:20px;}
.card{background:#1c1c25;padding:20px;border-radius:10px;margin-bottom:20px;}
.hidden{display:none}
#single img, #single iframe{max-width:100%;height:auto;object-fit:cover;border-radius:10px;margin:15px 0;}
#singleContent{line-height:1.7;}
#chatBox{display:none;position:fixed;bottom:20px;right:20px;width:350px;height:500px;background:#1c1c25;border-radius:10px;box-shadow:0 10px 25px rgba(0,0,0,0.4);overflow:hidden;flex-direction:column;z-index:1000;}
#chatMessages{flex-grow:1;padding:10px;overflow-y:auto;}
#chatInput{flex-grow:1;padding:10px;border:none;background:#0e0e11;color:#fff;outline:none;}
#chatSend{padding:0 15px;border:none;background:#ff4d4d;color:#fff;cursor:pointer;font-weight:600;}
</style>

<!-- Webpushr -->
<script>
(function(w,d,s,id){
  if(typeof(w.webpushr)!=='undefined') return;
  w.webpushr=w.webpushr||function(){
    (w.webpushr.q=w.webpushr.q||[]).push(arguments)
  };
  var js,fjs=d.getElementsByTagName(s)[0];
  js=d.createElement(s); js.id=id; js.async=1;
  js.src="https://cdn.webpushr.com/app.min.js";
  js.onload=function(){
    webpushr('setup',{
      'key':'BKdp3zSvl_w5aJH_c9naFADnGMJxh9khCwh0THm4hfU-PGhMZN8V5XpQt0nAqFULqVBjWSUk6lWblBhDYRbhWt4'
    });
  };
  fjs.parentNode.appendChild(js);
}(window,document,'script','webpushr-jssdk'));
</script>
</head>

<body>
<header>
  <h1>RSM</h1>
</header>

<nav>
  <a onclick="showSection('home')">Home</a>
  <a onclick="showSection('articles')">Articoli</a>
  <a onclick="showSection('videos')">Video</a>
  <a onclick="showSection('news')">News</a>
  <a onclick="showSection('categories')">Categorie</a>
  <a onclick="showSection('about')">Chi siamo?</a>
  <a onclick="showSection('contacts')">Contatti</a>

  <div id="searchBox">
    <input id="searchInput" placeholder="Cerca..." oninput="searchAll()">
    <div id="searchResults"></div>
  </div>

  <!-- Chatbot AI -->
  <div id="chatBotContainer" style="position:relative;margin-left:15px;">
    <button id="chatToggle" style="padding:8px 12px;border:none;border-radius:20px;background:#ff4d4d;color:#fff;cursor:pointer;">
      Chat AI
    </button>
<div id="chatBox">
  <button id="chatClose" style="padding:5px 10px;margin:5px;background:#ff4d4d;color:#fff;border:none;border-radius:10px;cursor:pointer;">Chiudi AI</button>
  <div id="chatMessages"></div>
  <div style="display:flex;border-top:1px solid #333;">
    <input id="chatInput" type="text" placeholder="Scrivi qui..." autocomplete="off">
    <button id="chatSend">Invia</button>
      </div>
    </div>
  </div>
</nav>

<main>
<section id="home">
  <div id="latestNews" class="card" style="border-left:5px solid #ff4d4d">
    <h2>ðŸŸ¥ Ultima notizia</h2>
    <h3 id="latestTitle"></h3>
    <p style="opacity:.7">Clicca per leggere la notizia completa</p>
  </div>
  <div id="latestVideo" class="card" style="border-left:5px solid #4da6ff">
    <h2>ðŸŽ¬ Ultimo video</h2>
    <h3 id="latestVideoTitle"></h3>
    <p style="opacity:.7">Clicca per guardare il video completo</p>
  </div>
</section>

<section id="articles" class="hidden"></section>
<section id="videos" class="hidden"></section>
<section id="news" class="hidden"></section>
<section id="categories" class="hidden"></section>

<section id="about" class="hidden">
  <div class="card">
    <h2>Chi siamo?</h2>
    <p id="publicDescription"></p>
  </div>
</section>

<section id="contacts" class="hidden">
  <div class="card">
    <h2>Contatti</h2>
    <p>ðŸ“ž +39 351 093 3272</p>
    <p>ðŸ“§ rsm260511@gmail.com</p>
  </div>
</section>

<section id="single" class="hidden card">
  <h2 id="singleTitle"></h2>
  <p id="singleDate" style="opacity:.6;font-size:14px;margin-top:-10px"></p>
  <div id="singleImage"></div>
  <div id="singleContent"></div>
</section>
</main>

<footer style="text-align:center;padding:20px;font-size:14px;opacity:.6">
Â© 2025 â€“ RSM | Tutti i diritti riservati
</footer>
<script>
// DATI
let articles=[];
fetch('https://raw.githubusercontent.com/rsm260511-web/RSM/main/data.json')
.then(r=>r.json())
.then(data=>{
  document.getElementById('publicDescription').innerText=data.description;
  articles = data.articles;
  renderArticles();
  renderVideos();
  renderNews();
  renderCategories();
  renderLatestNews();
  renderLatestVideo();
});

// SEZIONI
function showSection(id){
  document.querySelectorAll('main section').forEach(s=>s.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
  window.scrollTo(0,0);
}

// RENDER ARTICOLI, VIDEO, NEWS, CATEGORIE
function renderArticles() {
    const c = document.getElementById('articles');
    c.innerHTML = '';
    articles.filter(a => a.type === "article").forEach(a => {
        const i = articles.indexOf(a);
        const d = document.createElement('div');
        d.className = 'card';
        d.innerHTML = `<h2>${a.title}</h2>`;
        d.onclick = () => openArticle(i);
        c.appendChild(d);
    });
}

function renderVideos() {
    const c = document.getElementById('videos');
    c.innerHTML = '';
    articles.filter(a => a.type === "video").forEach(a => {
        const i = articles.indexOf(a);
        const d = document.createElement('div');
        d.className = 'card';
        d.innerHTML = `<h2>${a.title}</h2>`;
        d.onclick = () => openVideo(i);
        c.appendChild(d);
    });
}

function renderNews() {
    const c = document.getElementById('news');
    c.innerHTML = '';
    articles.filter(a => a.type === "news").forEach(a => {
        const i = articles.indexOf(a);
        const d = document.createElement('div');
        d.className = 'card';
        d.innerHTML = `<h2>${a.title}</h2>`;
        d.onclick = () => openArticle(i);
        c.appendChild(d);
    });
}

function renderCategories() {
    const c = document.getElementById('categories');
    c.innerHTML = '';
    [...new Set(articles.map(a => a.category))].forEach(cat => {
        const box = document.createElement('div');
        box.className = 'card';
        box.innerHTML = `<h2>${cat}</h2>`;
        articles.filter(a => a.category === cat).forEach(a => {
            const i = articles.indexOf(a);
            const p = document.createElement('p');
            p.style.cursor = 'pointer';
            p.innerText = "â€¢ " + a.title;
            // âœ… apertura corretta per articoli o video
            p.onclick = () => {
                if (a.type === "video") {
                    openVideo(i);
                } else {
                    openArticle(i);
                }
            };
            box.appendChild(p);
        });
        c.appendChild(box);
    });
  }
// OPEN ARTICOLI/VIDEO
function openArticle(i){const a=articles[i]; showSection('single'); document.getElementById('singleTitle').innerText=a.title; document.getElementById('singleDate').innerText=a.date?("ðŸ“… Pubblicato il "+new Date(a.date).toLocaleDateString('it-IT')):""; const imgBox=document.getElementById('singleImage'); imgBox.innerHTML=''; if(a.images && Array.isArray(a.images)){ a.images.forEach(src=>{const img=document.createElement('img'); img.src=src; imgBox.appendChild(img);}); } else if(a.image){imgBox.innerHTML=`<img src="${a.image}">`; } document.getElementById('singleContent').innerHTML=`<p>${a.content.replace(/\n/g,"<br><br>")}</p>`;}
function openVideo(i){const a=articles[i]; showSection('single'); document.getElementById('singleTitle').innerText=a.title; document.getElementById('singleDate').innerText=a.date?("ðŸ“… Pubblicato il "+new Date(a.date).toLocaleDateString('it-IT')):""; const imgBox=document.getElementById('singleImage'); imgBox.innerHTML=''; if(a.videoUrl){ imgBox.innerHTML=`<iframe width="100%" height="600" src="${a.videoUrl}" frameborder="0" allowfullscreen></iframe>`;} else if(a.images && Array.isArray(a.images)){ a.images.forEach(src=>{const img=document.createElement('img'); img.src=src; imgBox.appendChild(img);}); } document.getElementById('singleContent').innerHTML=`<p>${a.content.replace(/\n/g,"<br><br>")}</p>`;}

// SEARCH
function searchAll(){const q=searchInput.value.toLowerCase(); const box=searchResults; box.innerHTML=''; if(!q){box.style.display='none'; return;} articles.forEach((a,i)=>{if(a.title.toLowerCase().includes(q) || a.content.toLowerCase().includes(q)){const d=document.createElement('div'); d.className='search-item'; d.innerText=a.title; d.onclick=()=>openArticle(i); box.appendChild(d);}}); box.style.display=box.children.length?'block':'none';}

// LATEST NEWS & VIDEO
function renderLatestNews(){const news=articles.filter(a=>a.type==="news").sort((a,b)=>new Date(b.date)-new Date(a.date))[0]; if(!news) return; document.getElementById('latestTitle').innerText=news.title; const i=articles.findIndex(a=>a.title===news.title); document.getElementById('latestNews').onclick=()=>openArticle(i);}
function renderLatestVideo(){const video=articles.filter(a=>a.type==="video").sort((a,b)=>new Date(b.date)-new Date(a.date))[0]; if(!video) return; document.getElementById('latestVideoTitle').innerText=video.title; const i=articles.findIndex(a=>a.title===video.title); document.getElementById('latestVideo').onclick=()=>openVideo(i);}

// CHATBOT AI
const chatToggle=document.getElementById('chatToggle');
const chatBox=document.getElementById('chatBox');
const chatMessages=document.getElementById('chatMessages');
const chatInput=document.getElementById('chatInput');
const chatSend=document.getElementById('chatSend');

let lastQuestion = null; // traccia domanda per SÃŒ/NO

// Apri/Chiudi chat
chatToggle.addEventListener('click',()=>{chatBox.style.display=chatBox.style.display==='flex'?'none':'flex';});
const chatClose = document.getElementById('chatClose');

chatClose.addEventListener('click', () => {
  chatBox.style.display = 'none';
});
// Aggiungi messaggio
function appendMessage(sender,text){
  const div=document.createElement('div');
  div.textContent=text;
  div.style.margin='5px';
  div.style.padding='8px 12px';
  div.style.borderRadius='15px';
  div.style.maxWidth='80%';
  div.style.wordWrap='break-word';
  div.style.alignSelf=sender==='user'?'flex-end':'flex-start';
  div.style.background=sender==='user'?'#007bff':'#333';
  div.style.color='#fff';
  chatMessages.appendChild(div);
  chatMessages.scrollTop=chatMessages.scrollHeight;
}

// Invio messaggio
function sendMessage(){
  const msg=chatInput.value.trim();
  if(!msg) return;
  appendMessage('user',msg);
  appendMessage('bot',botResponse(msg));
  chatInput.value='';
}
chatSend.addEventListener('click',sendMessage);
chatInput.addEventListener('keypress',e=>{if(e.key==='Enter') sendMessage();});

// BOT RESPONSES
function botResponse(msg){
  const m=msg.toLowerCase();
  const responses=[
    "Ciao! ðŸ‘‹ Come va?",
    "Di nulla! ðŸ˜„ Chiedimi pure qualsiasi informazione.",
    "Certo! ðŸ˜Š Posso aiutarti con Contatti, Chi siamo o Articoli.",
    "Vuoi vedere gli ultimi articoli?",
    "Vuoi vedere l'ultimo video?",
    "Vuoi leggere l'ultima news?",
    "Puoi chiedere informazioni sui contenuti.",
    "Ecco alcune info sul sito.",
    "Posso aiutarti a navigare il sito.",
    "Vuoi sapere chi siamo?",
    "Ecco i nostri contatti.",
    "Puoi chiedere info sugli articoli.",
    "Puoi chiedere info sui video.",
    "Puoi chiedere info sulle news.",
    "Vuoi un consiglio su cosa leggere?",
    "Vuoi un consiglio su cosa guardare?",
    "Ecco un suggerimento per te.",
    "Puoi riassumere un articolo o una news.",
    "Se vuoi, posso aprire un articolo per te.",
    "Vuoi esplorare le categorie?",
    "Questa categoria contiene molti articoli.",
    "Posso aiutarti a trovare contenuti.",
    "Vuoi vedere contenuti recenti?",
    "Vuoi vedere contenuti popolari?",
    "Vuoi aprire un video specifico?",
    "Vuoi aprire un articolo specifico?",
    "Vuoi aprire una news specifica?",
    "Puoi chiedere info su una data news.",
    "Puoi chiedere info su un video recente.",
    "Puoi chiedere info su un articolo recente.",
    "Vuoi sapere di piÃ¹ su di noi?",
    "Vuoi sapere i contatti e email?",
    "Vuoi sapere il numero di telefono?",
    "Ecco il numero di telefono: +39 351 093 3272",
    "Ecco l'email: rsm260511@gmail.com",
    "Vuoi aprire la sezione Articoli?",
    "Vuoi aprire la sezione Video?",
    "Vuoi aprire la sezione News?",
    "Vuoi aprire la sezione Categorie?",
    "Vuoi aprire la sezione Chi siamo?",
    "Vuoi aprire la sezione Contatti?",
    "Puoi cercare articoli con la barra di ricerca.",
    "Puoi cercare video con la barra di ricerca.",
    "Puoi cercare news con la barra di ricerca.",
    "Se vuoi, posso darti suggerimenti su cosa leggere."
  ];

  // GESTIONE CONTESTO SÃŒ/NO
  if(lastQuestion){
    if(m.includes("sÃ¬") || m.includes("si") || m.includes("yes")){
      let ans = "";
      switch(lastQuestion){
        case "Vuoi vedere gli ultimi articoli?": ans="Ecco gli ultimi articoli!"; break;
        case "Vuoi vedere l'ultimo video?": ans="Ecco l'ultimo video!"; break;
        case "Vuoi leggere l'ultima news?": ans="Ecco l'ultima news!"; break;
        case "Vuoi aprire la sezione Articoli?": ans="Apro la sezione Articoli."; break;
        case "Vuoi aprire la sezione Video?": ans="Apro la sezione Video."; break;
        case "Vuoi aprire la sezione News?": ans="Apro la sezione News."; break;
        case "Vuoi esplorare le categorie?": ans="Apro le categorie."; break;
        case "Vuoi un riassunto veloce di un articolo o news?":
          if(!document.getElementById('single').classList.contains('hidden')){
            ans = summarizeText(document.getElementById('singleContent').innerText);
          } else {
            ans = "Apri prima l'articolo o scrivi il titolo esatto da riassumere.";
          }
          break;
        default: ans="Perfetto! ðŸ˜Š"; break;
      }
      lastQuestion=null;
      return ans;
    }
    if(m.includes("no") || m.includes("non") || m.includes("nope")){
      lastQuestion=null;
      return "Va bene, non c'Ã¨ problema.";
    }
  }

  // FRASI CHIAVE E RIASSUNTO
  if(m.includes('riassumi') || m.includes('fai un riassunto')){
    let titleMatch = articles.find(a => a.title.toLowerCase() === m.replace(/riassumi|fai un riassunto/gi,'').trim());
    if(titleMatch) return summarizeText(titleMatch.content);
    if(!document.getElementById('single').classList.contains('hidden')){
      return summarizeText(document.getElementById('singleContent').innerText);
    }
    return "Non ho trovato quell'articolo/news. Apri l'articolo o scrivi il titolo esatto da riassumere.";
  }

  // Aggancio domande principali al contesto
  if(m.includes("articolo")||m.includes("articoli")){ lastQuestion="Vuoi vedere gli ultimi articoli?"; return lastQuestion; }
  if(m.includes("video")){ lastQuestion="Vuoi vedere l'ultimo video?"; return lastQuestion; }
  if(m.includes("news")){ lastQuestion="Vuoi leggere l'ultima news?"; return lastQuestion; }
  if(m.includes("categorie")||m.includes("argomento")){ lastQuestion="Vuoi esplorare le categorie?"; return lastQuestion; }

  // Risposte casuali
  return responses[Math.floor(Math.random()*responses.length)];
}

// Riassunto testuale semplice
function summarizeText(text,maxSentences=3){
  if(!text) return "Non c'Ã¨ testo da riassumere.";
  const sentences=text.split(/(?<=\.|\?|!)/);
  const wordCounts={};
  const words=text.toLowerCase().replace(/[^a-zÃ Ã¨Ã©Ã¬Ã²Ã¹\s]/g,'').split(/\s+/);
  words.forEach(w=>{if(w.length>3) wordCounts[w]=(wordCounts[w]||0)+1;});
  const sentenceScores=sentences.map(s=>{const sWords=s.toLowerCase().split(/\s+/);let score=0;sWords.forEach(w=>{if(wordCounts[w]) score+=wordCounts[w];});return {sentence:s,score};});
  sentenceScores.sort((a,b)=>b.score-a.score);
  const topSentences=sentenceScores.slice(0,maxSentences).map(s=>s.sentence.trim());
  return topSentences.join(' ');
}
</script>
</body>
  </html>




