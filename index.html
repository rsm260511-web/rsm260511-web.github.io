<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>RSM</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/png" href="rsm-header.png">

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">

<style>
body{margin:0;font-family:'Montserrat',sans-serif;background:#0e0e11;color:#eaeaea;}
header{background:linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.9)),url('https://images.unsplash.com/photo-1500530855697-b586d89ba3ee');background-size:cover;padding:80px 20px;text-align:center;}
header h1{font-family:'Playfair Display',serif;font-size:52px;margin:0;}
nav{background:#15151c;padding:12px;display:flex;gap:15px;align-items:center;flex-wrap:wrap;}
nav a{cursor:pointer;font-weight:600;}
#searchBox{margin-left:auto;position:relative;}
#searchInput{padding:8px 10px;border-radius:20px;border:none;width:220px;}
#searchResults{position:absolute;top:38px;background:#1c1c25;width:100%;border-radius:10px;display:none;z-index:10;}
.search-item{padding:10px;cursor:pointer;}
.search-item:hover{background:#2a2a35;}
main{max-width:900px;margin:auto;padding:20px;}
.card{background:#1c1c25;padding:20px;border-radius:10px;margin-bottom:20px;}
.hidden{display:none}
#single img,#single iframe{max-width:100%;border-radius:10px;margin:15px 0}

/* CHAT */
#chatBox{display:none;position:absolute;top:45px;right:0;width:340px;height:480px;background:#1c1c25;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.4);flex-direction:column;z-index:1000}
#chatMessages{flex:1;padding:10px;overflow-y:auto}
#chatInput{flex:1;padding:10px;border:none;background:#0e0e11;color:#fff}
#chatSend{padding:0 15px;border:none;background:#ff4d4d;color:#fff;font-weight:600}
</style>

<!-- Webpushr -->
<script>
(function(w,d,s,id){
 if(typeof(w.webpushr)!=='undefined')return;
 w.webpushr=w.webpushr||function(){(w.webpushr.q=w.webpushr.q||[]).push(arguments)};
 var js,fjs=d.getElementsByTagName(s)[0];
 js=d.createElement(s);js.id=id;js.async=1;
 js.src="https://cdn.webpushr.com/app.min.js";
 js.onload=function(){
  webpushr('setup',{key:'BKdp3zSvl_w5aJH_c9naFADnGMJxh9khCwh0THm4hfU-PGhMZN8V5XpQt0nAqFULqVBjWSUk6lWblBhDYRbhWt4'});
 };
 fjs.parentNode.appendChild(js);
}(window,document,'script','webpushr-jssdk'));
</script>
</head>

<body>

<header><h1>RSM</h1></header>

<nav>
<a onclick="showSection('home')">Home</a>
<a onclick="showSection('articles')">Articoli</a>
<a onclick="showSection('videos')">Video</a>
<a onclick="showSection('news')">News</a>
<a onclick="showSection('categories')">Categorie</a>
<a onclick="showSection('about')">Chi siamo?</a>
<a onclick="showSection('contacts')">Contatti</a>

<div id="searchBox">
<input id="searchInput" placeholder="Cerca..." oninput="searchAll()">
<div id="searchResults"></div>
</div>

<div style="position:relative">
<button id="chatToggle" style="background:#ff4d4d;color:#fff;border:none;border-radius:20px;padding:8px 12px">Chat AI</button>
<div id="chatBox">
<div id="chatMessages"></div>
<div style="display:flex">
<input id="chatInput" placeholder="Scrivi...">
<button id="chatSend">Invia</button>
</div>
</div>
</div>
</nav>

<main>
<section id="home">
<div id="latestNews" class="card" onclick="openArticle(latestNewsIndex)">
<h2>ðŸŸ¥ Ultima news</h2><h3 id="latestNewsTitle"></h3>
</div>
<div id="latestVideo" class="card" onclick="openVideo(latestVideoIndex)">
<h2>ðŸŽ¬ Ultimo video</h2><h3 id="latestVideoTitle"></h3>
</div>
</section>

<section id="articles" class="hidden"></section>
<section id="videos" class="hidden"></section>
<section id="news" class="hidden"></section>
<section id="categories" class="hidden"></section>

<section id="about" class="hidden"><div class="card"><p id="publicDescription"></p></div></section>
<section id="contacts" class="hidden"><div class="card">
<p>ðŸ“ž +39 351 093 3272</p>
<p>ðŸ“§ rsm260511@gmail.com</p>
</div></section>

<section id="single" class="hidden card">
<h2 id="singleTitle"></h2>
<p id="singleDate"></p>
<div id="singleImage"></div>
<div id="singleContent"></div>
</section>
</main>

<footer style="text-align:center;opacity:.6;padding:20px">Â© 2025 RSM</footer>

<script>
let articles=[],latestNewsIndex=0,latestVideoIndex=0;

fetch('https://raw.githubusercontent.com/rsm260511-web/RSM/main/data.json')
.then(r=>r.json())
.then(data=>{
 document.getElementById('publicDescription').innerText=data.description;
 articles=data.articles;
 renderAll();
});

function renderAll(){
 renderArticles();renderVideos();renderNews();renderCategories();
 renderLatest();
}

function showSection(id){
 document.querySelectorAll('main section').forEach(s=>s.classList.add('hidden'));
 document.getElementById(id).classList.remove('hidden');
 window.scrollTo(0,0);
}

function renderArticles(){
 const c=document.getElementById('articles');c.innerHTML='';
 articles.filter(a=>a.type==="article").forEach(a=>{
  const i=articles.indexOf(a);
  c.innerHTML+=`<div class="card" onclick="openArticle(${i})"><h2>${a.title}</h2></div>`;
 });
}

function renderVideos(){
 const c=document.getElementById('videos');c.innerHTML='';
 articles.filter(a=>a.type==="video").forEach(a=>{
  const i=articles.indexOf(a);
  c.innerHTML+=`<div class="card" onclick="openVideo(${i})"><h2>${a.title}</h2></div>`;
 });
}

function renderNews(){
 const c=document.getElementById('news');c.innerHTML='';
 articles.filter(a=>a.type==="news").forEach(a=>{
  const i=articles.indexOf(a);
  c.innerHTML+=`<div class="card" onclick="openArticle(${i})"><h2>${a.title}</h2></div>`;
 });
}

function renderCategories(){
 const c=document.getElementById('categories');c.innerHTML='';
 [...new Set(articles.map(a=>a.category))].forEach(cat=>{
  let box=`<div class="card"><h2>${cat}</h2>`;
  articles.filter(a=>a.category===cat).forEach(a=>{
   box+=`<p onclick="openArticle(${articles.indexOf(a)})">â€¢ ${a.title}</p>`;
  });
  c.innerHTML+=box+'</div>';
 });
}

function renderLatest(){
 const news=articles.filter(a=>a.type==="news");
 const videos=articles.filter(a=>a.type==="video");
 if(news.length){latestNewsIndex=articles.indexOf(news[0]);latestNewsTitle.innerText=news[0].title}
 if(videos.length){latestVideoIndex=articles.indexOf(videos[0]);latestVideoTitle.innerText=videos[0].title}
}

function openArticle(i){
 const a=articles[i];
 showSection('single');
 singleTitle.innerText=a.title;
 singleDate.innerText=a.date||'';
 singleImage.innerHTML='';
 (a.images||[a.image]).filter(Boolean).forEach(src=>{
  singleImage.innerHTML+=`<img src="${src}">`;
 });
 singleContent.innerHTML=a.content.replace(/\n/g,"<br><br>");
}

function openVideo(i){
 const a=articles[i];
 showSection('single');
 singleTitle.innerText=a.title;
 singleImage.innerHTML=`<iframe width="100%" height="420" src="${a.videoUrl}" allowfullscreen></iframe>`;
 singleContent.innerHTML=a.content.replace(/\n/g,"<br><br>");
}

/* SEARCH */
function searchAll(){
 const q=searchInput.value.toLowerCase();
 searchResults.innerHTML='';
 if(!q)return searchResults.style.display='none';
 articles.forEach((a,i)=>{
  if(a.title.toLowerCase().includes(q)){
   searchResults.innerHTML+=`<div class="search-item" onclick="openArticle(${i})">${a.title}</div>`;
  }
 });
 searchResults.style.display='block';
}

/* CHAT */
chatToggle.onclick=()=>chatBox.style.display=chatBox.style.display==='flex'?'none':'flex';
chatSend.onclick=send;
chatInput.onkeypress=e=>e.key==="Enter"&&send();

function send(){
 if(!chatInput.value)return;
 chatMessages.innerHTML+=`<div style="text-align:right;color:#4da6ff">${chatInput.value}</div>`;
 chatMessages.innerHTML+=`<div>${bot(chatInput.value)}</div>`;
 chatInput.value='';
 chatMessages.scrollTop=9999;
}

function bot(m){
 m=m.toLowerCase();
 if(m.includes('ciao'))return"Hey! ðŸ‘‹";
 if(m.includes('contatti'))return"ðŸ“ž +39 351 093 3272<br>ðŸ“§ rsm260511@gmail.com";
 if(m.includes('articoli'))return"Puoi trovarli nella sezione Articoli.";
 if(m.includes('riassumi'))return singleContent.innerText.split('.').slice(0,3).join('.')+'.';
 return"Posso aiutarti con articoli, news, video o contatti.";
}
</script>
</body>
  </html>
