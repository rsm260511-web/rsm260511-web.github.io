<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>RSM</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/png" href="rsm-header.png">

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">

<style>
body{margin:0;font-family:'Montserrat',sans-serif;background:#0e0e11;color:#eaeaea;}
header{background:linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.9)),url('https://images.unsplash.com/photo-1500530855697-b586d89ba3ee');background-size:cover;background-position:center;padding:80px 20px;text-align:center;}
header h1{font-family:'Playfair Display',serif;font-size:52px;margin:0;}
nav{background:#15151c;padding:12px;display:flex;gap:15px;align-items:center;flex-wrap:wrap;}
nav a{cursor:pointer;font-weight:600;}
#searchBox{margin-left:auto;position:relative;}
#searchInput{padding:8px 10px;border-radius:20px;border:none;width:220px;}
#searchResults{position:absolute;top:38px;background:#1c1c25;width:100%;border-radius:10px;display:none;z-index:10;}
.search-item{padding:10px;cursor:pointer;}
.search-item:hover{background:#2a2a35;}
main{max-width:900px;margin:auto;padding:20px;}
.card{background:#1c1c25;padding:20px;border-radius:10px;margin-bottom:20px;}
.hidden{display:none}
#single img,#single iframe{max-width:100%;max-height:420px;object-fit:cover;border-radius:10px;margin:15px 0;}
#singleContent{line-height:1.7}

/* CHAT AI */
#chatBox{
  position:absolute;
  top:40px;
  right:0;
  width:350px;
  height:500px;
  background:#1c1c25;
  border-radius:10px;
  box-shadow:0 10px 25px rgba(0,0,0,.4);
  display:none;
  flex-direction:column;
  z-index:1000;
}
#chatMessages{flex:1;padding:10px;overflow-y:auto}
#chatInput{flex:1;padding:10px;border:none;background:#0e0e11;color:#fff}
#chatSend{padding:0 15px;border:none;background:#ff4d4d;color:#fff;cursor:pointer}
</style>

<!-- Webpushr -->
<script>
(function(w,d,s,id){
 if(typeof(w.webpushr)!=='undefined')return;
 w.webpushr=w.webpushr||function(){(w.webpushr.q=w.webpushr.q||[]).push(arguments)};
 var js,fjs=d.getElementsByTagName(s)[0];
 js=d.createElement(s);js.id=id;js.async=1;
 js.src="https://cdn.webpushr.com/app.min.js";
 js.onload=function(){webpushr('setup',{'key':'BKdp3zSvl_w5aJH_c9naFADnGMJxh9khCwh0THm4hfU-PGhMZN8V5XpQt0nAqFULqVBjWSUk6lWblBhDYRbhWt4'})};
 fjs.parentNode.appendChild(js);
}(window,document,'script','webpushr-jssdk'));
</script>
</head>

<body>

<header><h1>RSM</h1></header>

<nav>
<a onclick="showSection('home')">Home</a>
<a onclick="showSection('articles')">Articoli</a>
<a onclick="showSection('videos')">Video</a>
<a onclick="showSection('news')">News</a>
<a onclick="showSection('categories')">Categorie</a>
<a onclick="showSection('about')">Chi siamo?</a>
<a onclick="showSection('contacts')">Contatti</a>

<div id="searchBox">
<input id="searchInput" placeholder="Cerca..." oninput="searchAll()">
<div id="searchResults"></div>
</div>

<div style="position:relative">
<button id="chatToggle" style="padding:8px 12px;border:none;border-radius:20px;background:#ff4d4d;color:#fff">Chat AI</button>
<div id="chatBox">
  <div id="chatMessages"></div>
  <div style="display:flex;border-top:1px solid #333">
    <input id="chatInput" placeholder="Scrivi...">
    <button id="chatSend">Invia</button>
  </div>
</div>
</div>
</nav>

<main>
<section id="home">
<div id="latestNews" class="card"><h2>ðŸŸ¥ Ultima notizia</h2><h3 id="latestTitle"></h3></div>
<div id="latestVideo" class="card"><h2>ðŸŽ¬ Ultimo video</h2><h3 id="latestVideoTitle"></h3></div>
</section>

<section id="articles" class="hidden"></section>
<section id="videos" class="hidden"></section>
<section id="news" class="hidden"></section>
<section id="categories" class="hidden"></section>

<section id="about" class="hidden"><div class="card"><h2>Chi siamo?</h2><p id="publicDescription"></p></div></section>
<section id="contacts" class="hidden"><div class="card"><p>ðŸ“ž +39 351 093 3272<br>ðŸ“§ rsm260511@gmail.com</p></div></section>

<section id="single" class="hidden card">
<h2 id="singleTitle"></h2>
<p id="singleDate"></p>
<div id="singleImage"></div>
<div id="singleContent"></div>
</section>
</main>

<footer style="text-align:center;padding:20px;opacity:.6">Â© 2025 â€“ RSM</footer>

<script>
let articles=[];

fetch('https://raw.githubusercontent.com/rsm260511-web/RSM/main/data.json')
.then(r=>r.json())
.then(data=>{
 document.getElementById('publicDescription').innerText=data.description;
 articles=data.articles;
 renderArticles();renderVideos();renderNews();renderCategories();
 renderLatestNews();renderLatestVideo();
});

function showSection(id){
 document.querySelectorAll('main section').forEach(s=>s.classList.add('hidden'));
 document.getElementById(id).classList.remove('hidden');
}

function renderArticles(){
 const c=articles.filter(a=>a.type==="article");
 document.getElementById('articles').innerHTML=c.map(a=>`<div class="card" onclick="openArticle(${articles.indexOf(a)})"><h2>${a.title}</h2></div>`).join('');
}
function renderVideos(){
 const c=articles.filter(a=>a.type==="video");
 document.getElementById('videos').innerHTML=c.map(a=>`<div class="card" onclick="openVideo(${articles.indexOf(a)})"><h2>${a.title}</h2></div>`).join('');
}
function renderNews(){
 const c=articles.filter(a=>a.type==="news");
 document.getElementById('news').innerHTML=c.map(a=>`<div class="card" onclick="openArticle(${articles.indexOf(a)})"><h2>${a.title}</h2></div>`).join('');
}
function renderCategories(){
 const c=document.getElementById('categories');c.innerHTML='';
 [...new Set(articles.map(a=>a.category))].forEach(cat=>{
  const box=document.createElement('div');box.className='card';
  box.innerHTML=`<h2>${cat}</h2>`;
  articles.filter(a=>a.category===cat).forEach(a=>{
   const p=document.createElement('p');p.textContent="â€¢ "+a.title;
   p.onclick=()=>openArticle(articles.indexOf(a));box.appendChild(p);
  });c.appendChild(box);
 });
}

function openArticle(i){
 const a=articles[i];showSection('single');
 singleTitle.innerText=a.title;
 singleDate.innerText=a.date||'';
 singleImage.innerHTML=a.image?`<img src="${a.image}">`:'';
 singleContent.innerHTML=a.content.replace(/\n/g,"<br><br>");
}
function openVideo(i){
 const a=articles[i];showSection('single');
 singleTitle.innerText=a.title;
 singleImage.innerHTML=`<iframe width="100%" height="420" src="${a.videoUrl}" allowfullscreen></iframe>`;
 singleContent.innerHTML=a.content.replace(/\n/g,"<br><br>");
}

function renderLatestNews(){
 const n=articles.filter(a=>a.type==="news").sort((a,b)=>new Date(b.date)-new Date(a.date))[0];
 if(n){latestTitle.innerText=n.title;latestNews.onclick=()=>openArticle(articles.indexOf(n));}
}
function renderLatestVideo(){
 const v=articles.filter(a=>a.type==="video").sort((a,b)=>new Date(b.date)-new Date(a.date))[0];
 if(v){latestVideoTitle.innerText=v.title;latestVideo.onclick=()=>openVideo(articles.indexOf(v));}
}

/* CHAT */
chatToggle.onclick=()=>{chatBox.style.display=chatBox.style.display==='flex'?'none':'flex'};
chatSend.onclick=()=>send();
chatInput.onkeypress=e=>{if(e.key==='Enter')send()};

function send(){
 if(!chatInput.value)return;
 chatMessages.innerHTML+=`<div style="margin:5px;text-align:right">${chatInput.value}</div>`;
 chatMessages.innerHTML+=`<div style="margin:5px;color:#aaa">Posso aiutarti su articoli, news o contatti.</div>`;
 chatInput.value='';
 chatMessages.scrollTop=chatMessages.scrollHeight;
}
</script>
</body>
  </html>
